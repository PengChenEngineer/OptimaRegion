<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Confidence region for optima of Thin Plate Spline Models (2 regressors) — OptRegionTps • OptimaRegion</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Confidence region for optima of Thin Plate Spline Models (2 regressors) — OptRegionTps" />

<meta property="og:description" content="Computes and displays an approximated (1 - alpha) confidence region (CR) for
the linear-constrained maximum of a penalized Thin Plate Spline (TPS) model
in 2 controllable factors
(Del Castillo et al. 2019)
.
Generates a PDF file with a graph displaying the CR.
Grey region on output plot is the approximate CR. The mean coordinates (centroid)
of the optima is shown as a red point." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OptimaRegion</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Confidence region for optima of Thin Plate Spline Models (2 regressors)</h1>
    
    <div class="hidden name"><code>OptRegionTps.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Computes and displays an approximated (1 - alpha) confidence region (CR) for
the linear-constrained maximum of a penalized Thin Plate Spline (TPS) model
in 2 controllable factors
(Del Castillo et al. 2019)
.
Generates a PDF file with a graph displaying the CR.
Grey region on output plot is the approximate CR. The mean coordinates (centroid)
of the optima is shown as a red point.</p>
    
    </div>

    <pre class="usage"><span class='fu'>OptRegionTps</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>0.04</span>, <span class='kw'>nosim</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='no'>LB</span>, <span class='no'>UB</span>,
  <span class='kw'>triangularRegion</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>vertex1</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>vertex2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>maximization</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>nx2 matrix with the values of the 2 regressors (experimental factors)
in the n observations. Note: this can have replicates.
They will be eliminated by the program and the corresponding
y-values averaged</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>nx1 vector of response value observations, in the same order corresponding
to the rows of X</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>penalization parameter (larger values implies more smoothing).
Default is 0.04</p></td>
    </tr>
    <tr>
      <th>nosim</th>
      <td><p>number of simulations (default = 200)</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>confidence level (0 &lt; alpha &lt; 1; default = 0.05)</p></td>
    </tr>
    <tr>
      <th>LB</th>
      <td><p>vector of lower bounds for x (2x1 vector) above which the maximum is sought</p></td>
    </tr>
    <tr>
      <th>UB</th>
      <td><p>vector of upper bounds for x (2x1 vector) below which the maximum is sought</p></td>
    </tr>
    <tr>
      <th>triangularRegion</th>
      <td><p>logical: if TRUE it will constrain the maximum points to lie
inside a triangle defined by the coordinates (0,0), and those
in 'vertex1', and 'vertex2', see below (in addition to being
constrained to lie inside the region defined by LB and UB).
NOTE: use TRUE when the treatments form a triangular
experimental region in shape. If FALSE, maxima will only be
constrained to lie inside the rectangular region defined by
LB and UB. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>vertex1</th>
      <td><p>2 times 1 vector with coordinates defining one of the 3 vertices of
a triangular region. Must be provided if triangularRegion is TRUE
(NOTE: vertices numbered clockwise)</p></td>
    </tr>
    <tr>
      <th>vertex2</th>
      <td><p>2 times 1 vector with coordinates defining a second vertex of a
triangular region (third vertex is (0,0) by default). Must be provided
if triangularRegion is TRUE (NOTE: vertices numbered clockwise)</p></td>
    </tr>
    <tr>
      <th>maximization</th>
      <td><p>logical: if TRUE (default) it maximizes it FALSE it minimizes</p></td>
    </tr>
    <tr>
      <th>outputOptimaFile</th>
      <td><p>name of the text file containing the coordinates of all
the optima found (same information as in output vector xin, see below)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Upon completion, a PDF file containing the CR plot with name as set in
        ouputPDFFile is created and a text file with all xin values is created too.
        Also, the function returns a list containing
        the following 2 components:</p><dl class='dl-horizontal'>
          <dt>meanPoint</dt><dd><p>a 2x1 vector with the coordinates of the mean optimum
                             point (displayed as a red dot in the CR plot in output
                             PDF file)</p></dd>
          <dt>xin</dt><dd><p>an mx2 matrix with the x,y coordinates of all simulated
                       points that belong to the confidence region (dim(m) is
                       (1-alpha)*nosim)</p></dd>
        
</dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This program approximates the confidence region (CR) of the location of the optimum
of a Thin Plate Spline (TPS) in 2 regressors x constrained inside  a rectangular
region defined by LB and UB. If triangularRegion=TRUE it will also contrain the
optimum to lie inside the experimental region assumed to be well approximated by
a triangle. The CR is generated pointwise by bootstrapping the residuals of a TPS fit
to the given (X,y) data, refitting Tps models, and solving the corresponding
constrained maximization (or minimization) problems. The confidence region is
approximated by the convex hull of all the optimal solutions found. The CR
computation is based on the "CS" bootstrapping approach for building a confidence set
of a parametric function described in
Woutersen and Ham (2013)
.
This version of the program
uses nonparametric bootstrapping confidence regions to get the Confidence region of
the Tps parameters,using the notion of data depth according to
Yeh and Singh (1997)
.
Hence, this version does not rely on the normality assumption of the data.
The TPS models are fit using the "fields" R package
(Douglas Nychka et al. 2017)

and its "Tps" function.</p>
    
    <h2 class="hasAnchor" id="author-s-"><a class="anchor" href="#author-s-"></a>Author(s)</h2>

    

<p>Enrique del Castillo <a href='mailto:exd13@psu.edu'>exd13@psu.edu</a>,
Peng Chen <a href='mailto:pfc5098@psu.edu'>pfc5098@psu.edu</a>,
Adam Meyers <a href='mailto:akm5733@psu.edu'>akm5733@psu.edu</a>,
John Hunt <a href='mailto:J.Hunt@exeter.ac.uk'>J.Hunt@exeter.ac.uk</a> and
James Rapkin <a href='mailto:jr297@exeter.ac.uk'>jr297@exeter.ac.uk</a>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Del Castillo E, Chen P, Meyers A, Hunt J, Rapkin J (2019).
&#8220;Confidence regions for the location of response surface optima: the R package OptimaRegion.&#8221;<br /><br /> Douglas Nychka, Reinhard Furrer, John Paige, Stephan Sain (2017).
&#8220;fields: Tools for spatial data.&#8221;
doi: <a href='https://doi.org/10.5065/D6W957CT'>10.5065/D6W957CT</a>
, R package version 9.8-3, <a href='https://github.com/NCAR/Fields'>https://github.com/NCAR/Fields</a>.<br /><br /> Woutersen T, Ham J (2013).
&#8220;Confidence sets for Continuous and Discontinuous functions of parameters.&#8221;
<em>Technical report, University of Arizona</em>.<br /><br /> Yeh AB, Singh K (1997).
&#8220;Balanced confidence regions based on Tukey’s depth and the bootstrap.&#8221;
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>59</b>(3), 639--652.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Example 1: randomly generated 2-variable response surface data</span>
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>, -<span class='fl'>2</span>, <span class='fl'>2</span>), <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>, -<span class='fl'>2</span>, <span class='fl'>2</span>))
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='fl'>72</span> - <span class='fl'>11.78</span> * <span class='no'>X</span>[, <span class='fl'>1</span>] + <span class='fl'>0.74</span> * <span class='no'>X</span>[, <span class='fl'>2</span>] - <span class='fl'>7.25</span> * <span class='no'>X</span>[, <span class='fl'>1</span>]^<span class='fl'>2</span> -
  <span class='fl'>7.55</span> * <span class='no'>X</span>[, <span class='fl'>2</span>]^<span class='fl'>2</span> - <span class='fl'>4.85</span> * <span class='no'>X</span>[, <span class='fl'>1</span>] * <span class='no'>X</span>[, <span class='fl'>2</span>] + <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>100</span>, <span class='fl'>0</span>, <span class='fl'>8</span>))
<span class='co'># Find a 95 percent confidence region for the maximum of a Thin Plate Spline</span>
<span class='co'># model fitted to these data</span>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>OptRegionTps</span>(<span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>y</span>, <span class='kw'>nosim</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>LB</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>2</span>, -<span class='fl'>2</span>), <span class='kw'>UB</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>out</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"X1"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"X2"</span>)

<span class='co'># Example 2: a mixture-amount experiment in two components (Drug dataset) with</span>
<span class='co'># non-normal data. Note triangular experimental region. Resulting 95p confidence</span>
<span class='co'># region of the maxima of a TPS model has area &gt; 0. Contrast with region for</span>
<span class='co'># quadratic polynomial model. Note: 500 bootstrap iterations may take a few minutes.</span>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>OptRegionTps</span>(
  <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>Drug</span>[, <span class='fl'>1</span>:<span class='fl'>2</span>], <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>Drug</span>[, <span class='fl'>3</span>], <span class='kw'>nosim</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>LB</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0</span>),
  <span class='kw'>UB</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.08</span>, <span class='fl'>11</span>), <span class='kw'>triangularRegion</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>vertex1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.02</span>, <span class='fl'>11</span>), <span class='kw'>vertex2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.08</span>, <span class='fl'>1.8</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>out</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Component 1 (mg.)"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Component 2 (mg.)"</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#author-s-">Author(s)</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Enrique del Castillo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


