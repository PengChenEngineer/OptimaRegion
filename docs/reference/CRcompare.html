<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Confidence interval for the distance between two response surface optima (2 regressors) — CRcompare • OptimaRegion</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Confidence interval for the distance between two response surface optima (2 regressors) — CRcompare" />

<meta property="og:description" content="Computes bootstrapped confidence intervals for the mean and median
distance between the optima of two response surface models. Models can be thin
plate splines or quadratic polynomials
(Del Castillo et al. 2019)
." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OptimaRegion</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Confidence interval for the distance between two response surface optima (2 regressors)</h1>
    
    <div class="hidden name"><code>CRcompare.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Computes bootstrapped confidence intervals for the mean and median
distance between the optima of two response surface models. Models can be thin
plate splines or quadratic polynomials
(Del Castillo et al. 2019)
.</p>
    
    </div>

    <pre class="usage"><span class='fu'>CRcompare</span>(<span class='no'>X1</span>, <span class='no'>y1</span>, <span class='no'>X2</span>, <span class='no'>y2</span>, <span class='kw'>responseType</span> <span class='kw'>=</span> <span class='st'>"TPS"</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>0.04</span>,
  <span class='kw'>nosim1and2</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='no'>LB1</span>, <span class='no'>LB2</span>, <span class='no'>UB1</span>, <span class='no'>UB2</span>,
  <span class='kw'>triangularRegion1</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>vertex11</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>vertex21</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>triangularRegion2</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>vertex12</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>vertex22</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>maximization1</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>maximization2</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>xlab1and2</span> <span class='kw'>=</span> <span class='st'>"Protein eaten (mg)"</span>,
  <span class='kw'>ylab1and2</span> <span class='kw'>=</span> <span class='st'>"Carbohydrates eaten (mg)"</span>,
  <span class='kw'>outputPDFFile1</span> <span class='kw'>=</span> <span class='st'>"CR_plot1.pdf"</span>, <span class='kw'>outputOptimaFile1</span> <span class='kw'>=</span> <span class='st'>"Optima1.txt"</span>,
  <span class='kw'>outputPDFFile2</span> <span class='kw'>=</span> <span class='st'>"CR_plot2.pdf"</span>, <span class='kw'>outputOptimaFile2</span> <span class='kw'>=</span> <span class='st'>"Optima2.txt"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X1</th>
      <td><p>nx2 matrix with the values of the 2 regressors (experimental factors)
corresponding to the first response. Note: can have replicates. They
will be eliminated by the program and the corresponding y-values averaged</p></td>
    </tr>
    <tr>
      <th>y1</th>
      <td><p>nx1 vector of values for the first response corresponding to X1</p></td>
    </tr>
    <tr>
      <th>X2</th>
      <td><p>nx2 matrix with the values of the 2 regressors (experimental factors)
corresponding to the second response. Note: can have replicates. They
will be eliminated by the program and the corresponding y-values averaged</p></td>
    </tr>
    <tr>
      <th>y2</th>
      <td><p>nx1 vector of values for the second response corresponding to X2</p></td>
    </tr>
    <tr>
      <th>responseType</th>
      <td><p>use 'TPS' if fitting thin plate spline responses, 'Quad'
if fitting quadratic polynomials</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>psmoothing penalty if a TPS model is selected (default=0.04)</p></td>
    </tr>
    <tr>
      <th>nosim1and2</th>
      <td><p>number of simulations(default = 200) used to find each of the two
confidence regions of optima</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>confidence level (0 &lt; alpha &lt; 1; default = 0.05)</p></td>
    </tr>
    <tr>
      <th>LB1</th>
      <td><p>vector of lower bounds for x (2x1 vector) above which the optimum
is sought for the first response</p></td>
    </tr>
    <tr>
      <th>LB2</th>
      <td><p>vector of lower bounds for x (2x1 vector) above which the optimum
is sought for the second response</p></td>
    </tr>
    <tr>
      <th>UB1</th>
      <td><p>vector of upper bounds for x (2x1 vector) below which the optimum
is sought for the first response</p></td>
    </tr>
    <tr>
      <th>UB2</th>
      <td><p>vector of upper bounds for x (2x1 vector) below which the optimum
is sought for the second response</p></td>
    </tr>
    <tr>
      <th>triangularRegion1</th>
      <td><p>logical: if TRUE it will constrain the maximum points of
response 1 to lie inside a triangle defined by the coordinates (0,0), and those in
"vertex11", and "vertex21", see below (in addition to being constrained to
lie inside the region defined by LB1 and UB1). NOTE: use TRUE when the treatments
form a triangular experimental region in shape. If FALSE, optima will only be
constrained to lie inside the rectangular region defined by LB1 and UB1.
Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>vertex11</th>
      <td><p>2 times 1 vector with coordinates defining one of the
3 vertices of the triangular region where the first response is being
optimized. Must be provided if triangularRegion1 is TRUE
(NOTE: vertices numbered clockwise, with vertex0 fixed to (0,0))</p></td>
    </tr>
    <tr>
      <th>vertex21</th>
      <td><p>2 times 1 vector with coordinates defining a second
vertex of a triangular region where the first response is being
optimized. Must be provided if triangularRegion1 is TRUE</p></td>
    </tr>
    <tr>
      <th>triangularRegion2</th>
      <td><p>logical: if TRUE it will constrain the maximum points of
response 2 to lie inside a triangle defined by the coordinates (0,0), and those in
"vertex12", and "vertex22", see below (in addition to being constrained to
lie inside the region defined by LB2 and UB2).NOTE: use TRUE when the treatments
form a triangular experimental region in shape. If FALSE, optima will only be
constrained to lie inside the rectangular region defined by LB2 and UB2.
Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>vertex12</th>
      <td><p>2 times 1 vector with coordinates defining one of the
3 vertices of the triangular region where the second response is being
optimized. Must be provided if triangularRegion2 is TRUE
(NOTE: vertices numbered clockwise, with vertex0 fixed to (0,0))</p></td>
    </tr>
    <tr>
      <th>vertex22</th>
      <td><p>2 times 1 vector with coordinates defining a second
vertex of a triangular region where the second response is being
optimized. Must be provided if triangularRegion2 is TRUE</p></td>
    </tr>
    <tr>
      <th>maximization1</th>
      <td><p>logical: if TRUE (default) it maximizes response 1,
if FALSE it minimizes it</p></td>
    </tr>
    <tr>
      <th>maximization2</th>
      <td><p>logical: if TRUE (default) it maximizes response 2,
if FALSE it minimizes it</p></td>
    </tr>
    <tr>
      <th>xlab1and2</th>
      <td><p>text label for x axis in both confidence region plots
(default: "Protein eaten (mg)")</p></td>
    </tr>
    <tr>
      <th>ylab1and2</th>
      <td><p>text label for y axis in both confidence region plots
(default: "Carbohydrates eaten (mg)")</p></td>
    </tr>
    <tr>
      <th>outputPDFFile1</th>
      <td><p>name of the PDF file where the CR plot of the
first response is saved (default: "CR_plot.pdf")</p></td>
    </tr>
    <tr>
      <th>outputOptimaFile1</th>
      <td><p>name of the text file containing the coordinates of
all the simulated optima of the first response</p></td>
    </tr>
    <tr>
      <th>outputPDFFile2</th>
      <td><p>name of the PDF file where the CR plot of the
second response is saved (default: "CR_plot.pdf")</p></td>
    </tr>
    <tr>
      <th>outputOptimaFile2</th>
      <td><p>name of the text file containing the coordinates of
all the simulated optima of the second response</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Upon completion, two PDF files with the CR plots and two text files
        with the coordinates of each set of optima are created, and the
        function also returns a list consisting of the following 5 components:</p><dl class='dl-horizontal'>
          <dt>dist</dt><dd><p>vector of distances between pairs of points taken
                        from each set of optima</p></dd>
          <dt>mean</dt><dd><p>mean of dist</p></dd>
          <dt>median</dt><dd><p>median of dist</p></dd>
          <dt>ciMean</dt><dd><p>95<!-- % confidence interval for the mean of dist using -->
                          bca bootstrapping; it is a vector with 5 columns,
                          containing the signicance level, the next two
                          containing the indices of the order statistics used
                          in the calculations and the final two the calculated
                          endpoints of the CI's.</p></dd>
          <dt>ciMEdian</dt><dd><p>95<!-- % confidence interval for the median of dist -->
                            using bca bootstrapping; it is a vector with 5 columns,
                            containing the signicance level, the next two
                            containing the indices of the order statistics used
                            in the calculations and the final two the calculated
                            endpoints of the CI's.</p></dd>
        
</dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Computes distribution-free bootstrapped confidence intervals on the mean and
median distance between the optima of two different responses. The responses can
be Thin Plate Spline models or Quadratic polynomial models. Program calls
each response, next computes all pairwise distances between points in each CR,
and finally bootstraps the distances to compute bca bootstrapped confidence
intervals for the mean and median distance.</p>
    
    <h2 class="hasAnchor" id="author-s-"><a class="anchor" href="#author-s-"></a>Author(s)</h2>

    

<p>Enrique del Castillo <a href='mailto:exd13@psu.edu'>exd13@psu.edu</a>,
Peng Chen <a href='mailto:pfc5098@psu.edu'>pfc5098@psu.edu</a>,
Adam Meyers <a href='mailto:akm5733@psu.edu'>akm5733@psu.edu</a>,
John Hunt <a href='mailto:J.Hunt@exeter.ac.uk'>J.Hunt@exeter.ac.uk</a> and
James Rapkin <a href='mailto:jr297@exeter.ac.uk'>jr297@exeter.ac.uk</a>.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Del Castillo E, Chen P, Meyers A, Hunt J, Rapkin J (2019).
&#8220;Confidence regions for the location of response surface optima: the R package OptimaRegion.&#8221;</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Example: two randomly generated data sets, quadratic polynomial responses.</span>
<span class='no'>X1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>, -<span class='fl'>2</span>, <span class='fl'>2</span>), <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>, -<span class='fl'>2</span>, <span class='fl'>2</span>))
<span class='no'>y1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='fl'>72</span> - <span class='fl'>11.78</span> * <span class='no'>X1</span>[, <span class='fl'>1</span>] + <span class='fl'>0.74</span> * <span class='no'>X1</span>[, <span class='fl'>2</span>] - <span class='fl'>7.25</span> * <span class='no'>X1</span>[, <span class='fl'>1</span>]^<span class='fl'>2</span> -
  <span class='fl'>7.55</span> * <span class='no'>X1</span>[, <span class='fl'>2</span>]^<span class='fl'>2</span> - <span class='fl'>4.85</span> * <span class='no'>X1</span>[, <span class='fl'>1</span>] * <span class='no'>X1</span>[, <span class='fl'>2</span>] + <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>100</span>, <span class='fl'>0</span>, <span class='fl'>8</span>))
<span class='no'>X2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>, -<span class='fl'>2</span>, <span class='fl'>2</span>), <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>100</span>, -<span class='fl'>2</span>, <span class='fl'>2</span>))
<span class='no'>y2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='fl'>72</span> - <span class='fl'>11.78</span> * <span class='no'>X2</span>[, <span class='fl'>1</span>] + <span class='fl'>0.74</span> * <span class='no'>X2</span>[, <span class='fl'>2</span>] - <span class='fl'>7.25</span> * <span class='no'>X2</span>[, <span class='fl'>1</span>]^<span class='fl'>2</span> -
  <span class='fl'>7.55</span> * <span class='no'>X2</span>[, <span class='fl'>2</span>]^<span class='fl'>2</span> - <span class='fl'>4.85</span> * <span class='no'>X2</span>[, <span class='fl'>1</span>] * <span class='no'>X2</span>[, <span class='fl'>2</span>] + <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>100</span>, <span class='fl'>0</span>, <span class='fl'>8</span>))
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>CRcompare</span>(
  <span class='kw'>X1</span> <span class='kw'>=</span> <span class='no'>X1</span>, <span class='kw'>y1</span> <span class='kw'>=</span> <span class='no'>y1</span>, <span class='kw'>X2</span> <span class='kw'>=</span> <span class='no'>X2</span>, <span class='kw'>y2</span> <span class='kw'>=</span> <span class='no'>y2</span>, <span class='kw'>responseType</span> <span class='kw'>=</span> <span class='st'>"Quad"</span>, <span class='kw'>nosim1and2</span> <span class='kw'>=</span> <span class='fl'>200</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>LB1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>2</span>, -<span class='fl'>2</span>), <span class='kw'>UB1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>2</span>), <span class='kw'>LB2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>2</span>, -<span class='fl'>2</span>), <span class='kw'>UB2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>2</span>)
)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#author-s-">Author(s)</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Enrique del Castillo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


